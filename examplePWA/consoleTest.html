<!DOCTYPE html>
<html lang="en">
    <head>
        <!--
            noice.js example PWA
            serve from a server with a valid SSL cert

                - ❤️ Amy Hicox <amy@hicox.com> 8/26/21
        -->

        <!-- make it look like an app -->
        <meta charset="utf-8" />
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-title" content="Noice Example PWA">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

        <!-- app-ish assets -->
        <link rel="apple-touch-icon" href="./gfx/touch_icon.png">
        <link rel="apple-touch-startup-image" href="./gfx/splash_screen.png">
        <link rel="icon" type="image/png" href="./gfx/favicon.png">
        <link rel="manifest" href="./manifest.json">

        <!-- noice library includes -->
        <script src="./lib/noice/noiceCore.js"></script>
        <script src="./lib/noice/noiceApplicationCore.js"></script>
        <script src="./lib/noice/noiceCoreUI.js"></script>
        <script src="./lib/noice/noiceCoreUIFormElement.js"></script>
        <script src="./lib/noice/noiceCoreUITemplate.js"></script>
        <script src="./lib/noice/noiceCoreUIFormView.js"></script>
        <script src="./lib/noice/noiceCoreUIFormCloneView.js"></script>
        <script src="./lib/noice/noiceIndexedDB.js"></script>
        <script src="./lib/noice/UI/noiceRadialPolygonPath.js"></script>
        <script src="./lib/noice/UI/noicePieChart.js"></script>
        <script src="./lib/noice/UI/installHelpDialog.js"></script>
        <script src="./lib/noice/UI/startupDialog.js"></script>
        <script src="./lib/noice/UI/noiceBalloonDialog.js"></script>
        <script src="./lib/noice/UI/recordEditorUI.js"></script>
        <script src="./lib/noice/UI/splashDialog.js"></script>
        <script src="./lib/noice/formView.js"></script>

        <!-- custom UI Screen Module includes -->
        <script src="./lib/UI/mainUI.js"></script>
        <script src="./lib/UI/recipeEditorUI.js"></script>

        <!-- formViews -->
        <script src="./lib/UI/recipeFormView.js"></script>

        <!-- the config -->
        <script src="./config/appConfig.js"></script>

        <!-- the app -->
        <script src="./lib/noiceExamplePWA.js"></script>

        <!-- don't make Tim Gunn "question your taste level" mmmm'kay? -->
        <link rel="stylesheet" type="text/css" href="./noiceExamplePWA.css">

        <!-- for testing
        <link rel="stylesheet" type="text/css" href="./min.css">
        -->

        <!-- set up the app, then start it -->
        <script type="text/javascript">

            /*
                insert shenannigans here
            */


            document.addEventListener("DOMContentLoaded", function(evt){
                let info = document.createElement('ul');
                info.style.color = "rgb(240,240,240)";
                info.style.textAlign = 'left';
                info.style.fontSize = '.5em';
                info.style.maxHeight = '40vh';
                info.style.overflowY = 'scroll';

                let FUCK_YOU = {};
                for (let p in navigator){
                    FUCK_YOU[p] = navigator[p]
                }

                Object.keys(FUCK_YOU).sort().forEach(function(a){
                    info.insertAdjacentHTML('beforeend', `<li>[${a}]: ${FUCK_YOU[a]}</li>`)
                });
                document.body.append(info);

                function identify(){

                    if (navigator){

                        // detect iOS
                        if (
                            ('vendor' in navigator) &&
                            (/Apple/.test(navigator.vendor)) &&
                            ('maxTouchPoints' in navigator) &&
                            (parseInt(navigator.maxTouchPoints) > 0)
                        ){
                            return('Safari Mobile');

                        // detect desktop safari
                        } else if (
                            ('vendor' in navigator) &&
                            (/Apple/.test(navigator.vendor)) &&
                            ('maxTouchPoints' in navigator) &&
                            (parseInt(navigator.maxTouchPoints) == 0)
                        ){
                            return('Safari');

                        // detect chrome
                        } else if (
                            ('vendor' in navigator) &&
                            (/Google/.test(navigator.vendor)) &&
                            (/Chrome\//.test(navigator.userAgent))
                        ){
                            return('Chrome');

                        // detect edge
                        }else if (
                            (/Edg\//.test(navigator.userAgent)) ||
                            (/Edge\//.test(navigator.userAgent))
                        ){
                            return('Edge');

                        // detect firefox
                        }else if (
                            (/Firefox\//.test(navigator.userAgent))
                        ){
                            return('Firefox');
                        }
                    }
                }
                document.body.insertAdjacentHTML('beforeend', `<h2 style="color:rgb(240,240,240);">detected: ${identify()}</h2>`);

            });

        </script>
    </head>
    <body></body>
</html>
